!function(e){function n(e){if("undefined"!=typeof google&&google.loader.ClientLocation){var n=google.loader.ClientLocation.address.country_code;return n in e?n:"US"}return"US"}function t(e){return"<span class='country flag-"+e.id+"'></span>"+e.text}function r(e,n){for(var t=0;t<e.length;t++){var r=n?d.tollFree[u]:"standard";document.getElementById(d[e[t]]).innerHTML="$"+l[e[t]][r]}}function o(e,t){for(var r=t.split(","),o=0;o<r.length;o++){var i=document.getElementById(r[o].replace(/\s/,"")),a=new String,c=n(e);for(k in e)if(e.hasOwnProperty(k)){var s=e[k].beta;if(s)continue;var l=e[k].name||e[k].country;if("undefined"==typeof l)continue;e[k].toll_free&&(a+='<option value="'+k+'-TF">'+l+" (toll free) "+"</option>");var f=c==k?"selected = selected":"";a+='<option value="'+k+'"'+f+">"+l+"</option>"}i.innerHTML=a}}function i(e){var n=-1!==e.indexOf("-TF"),t=e.replace(/-TF/gi,""),o=f[t],i=n?o.toll_free:o.national||o.local;u=n?t:null,document.getElementById("number_price").innerHTML="$ "+i,r(["INCOMING","VOICEMAIL"],n)}function a(e,n){var t=new String;for(item in e)e.hasOwnProperty(item)&&(t+='<tr><td class="prefixes">'+e[item].prefix.replace(/,/g,", ")+"</td>",t+='<td class="rates"><span class="prices"> $'+e[item].price+"</span>"+'<div class="rate-arb">'+"<span>per min.</span>"+"</div>"+"</td>"+"</tr>");document.getElementById(n).innerHTML="$"+e[0].price,document.getElementById(n+"_table").innerHTML=t}function c(e,n){var t=l[e],r=t.numbers,o=u&&"outgoing"!==n?d.tollFree[u]:n;charges=[];for(prefix in r)if(r.hasOwnProperty(prefix)){var i=parseFloat(r[prefix][o]);charges.push({prefix:prefix,price:i})}a(charges.sort(function(e,n){return e.price-n.price}),d.requestType[n])}function s(){e("#ff_no").bind("change",function(){var n=e(this).val();i(n),e("#standard").trigger("change")}),e("#standard, #outgoing").bind("change",function(){var n=e(this).val(),t=e(this).attr("id");c(n,t)})}var l={},f={},u=null,d={INCOMING:"incoming_via_browser",VOICEMAIL:"voice_mail",tollFree:{US:"usca_tollfree",GB:"uk_tollfree",CA:"usca_tollfree"},requestType:{standard:"incoming_via_phone",outgoing:"outgoing_via_phone"}};e(document).ready(function(){e.getJSON("/themes/fixnix/javascripts/number-rates.json",function(e){f=e,o(f,"ff_no")}).done(function(){e.getJSON("/themes/fixnix/javascripts/freshfone_charges.json",function(e){l=e,o(l,"standard, outgoing"),s()}).done(function(){e("#ff_no, #standard, #outgoing").select2({width:"resolve",formatResult:t,formatSelection:t,escapeMarkup:function(e){return e}}).trigger("change")})}),e("body").on("click",".detailed-pricing",function(n){n.preventDefault(),e(this).parent().next().slideToggle(100)})})}(jQuery);